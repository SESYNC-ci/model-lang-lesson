---
---

## Exercises

===

### Exercise 1

Regress "hindfoot_length" against "species_id" and the log of "weight". Does it
appear that the Chihuahuan Desert's common kangaroo rats (DM) have largish feet
for their weight?

[View solution](#solution-3)
{:.notes}

===

### Exercise 2

Weight is actually a positive integer in this dataset. Fit the log of weight
against species ID using `lm()`, and fit raw weight against species ID using
`glm()` with the Poisson family. According the the `anova()` table, are both
models plausible? Hint: you may need to provide additional arguments to
`anova()`.

[View solution](#solution-2)
{:.notes}

===

### Exercise 3

You are standing in the Chihuahuan desert, when a pocket mouse (genus
*Perognathus*) suddenly runs up your pant leg. It weighs down your pocket quite
a bit, relative to your many similar pocket mouse experiences. Run a binomial
family GLM on the two Perognathus species in the animals table that may help you
predict to which species it belongs. Hint: Begin by mutating `species_id` into a
`factor()` with `levels = c("PF", "PH")`.

[View solution](#solution-3)
{:.notes}

===

### Exercise 4

Write down the formula for a random intercepts model with a fixed effect of
sex and a random effect of plot on each animal's weight.

[View solution](#solution-4)
{:.notes}

===

### Exercise 5

Use `stan_glm` to evaluate the logistic regression performed earlier with `glm`
on sex as predicted by the log of hindfoot_length.

===

## Solutions

===

### Solution 1

```{r, handout = 0}
fit <- lm(
  hindfoot_length ~ species_id + log(weight),
  data = animals)
```

===

The estimated coefficient for "species_idDM" and associated "***" suggest
"yes".

```{r}
summary(fit)
```

[Return](#exercise-1)
{:.notes}

===

### Solution 2

```{r ex-glm, handout = 0}
fit_lm <- lm(log(weight) ~ species_id,
             data = animals)
fit_glm <- glm(weight ~ species_id,
               family = poisson,
               data = animals)
```

===

```{r}
anova(fit_lm)
```

===

```{r}
anova(fit_glm, test = 'Chisq')
```

[Return](#exercise-2)
{:.notes}

===

### Solution 3

```{r ex-logit, handout = 0}
perognathus <- animals
perognathus$species_id <- factor(
  perognathus$species_id, levels = c('PF', 'PH'))
fit <- glm(species_id ~ weight,
    family = binomial,
    data = perognathus)
```

===

The negative intercept is due to the much higher frequency of "failures" (the first level or *P. flavus*). The positive effect of weight means you've probably got a *P hispidus* in your pocket.

```{r ex-logit-2}
summary(fit)
```

[Return](#exercise-3)
{:.notes}

===

### Solution 4

```{r eval = FALSE}
weight ~ (1 | plot_id) + sex
```

[Return](#exercise-4)
{:.notes}

===

### Solution 5

```{r, eval = FALSE, handout = 0}
library(rstanarm)
fit <- stan_glm(
    sex ~ log(hindfoot_length),
    data = animals, 
    family = binomial(), 
    chains = 2, cores = 2, iter = 1000)
```
