---
---

## Generalized Linear Models

The `lm` function treats the response variable as numeric---the `glm` function lifts this restriction and others. Not through the `formula` syntax, which is the same for calls to `lm`  and `glm`, but through addition of the `family` argument.

===

### GLM Families

The `family` argument determines the family of probability distributions in which the response variable belongs. A key difference between families is the data type and range.

===

| Family             | Data Type | *Default* link                         |
|--------------------|-----------|----------------------------------------|
| `gaussian`         | `double`  | *identity*, log, inverse               |
| `binomial`         | `boolean` | *logit*, probit, cauchit, log, cloglog |
| `poisson`          | `integer` | *log*, identity, sqrt                  |
| `Gamma`            | `double`  | *inverse*, identity, log               |
| `inverse.gaussian` | `double`  | *"1/mu^2"*, inverse, identity, log     |

===

The model fit in exercise 1 is (almost) identically produced with a GLM
using the Gaussian family and identity link.

```{r glm_weight, title = "{{ site.handouts[0] }}"}
fit <- glm(log(weight) ~ species_id,
    family = gaussian,
    data = animals)
```

===

```{r glm_weight_summary}
summary(fit)
```

===

Question
: Should the coeficient estimates between this Gaussian `glm()` and the previous
`lm()` be different?

Answer
: {:.fragment} It's possible. The `lm()` function uses a different (less
general) fitting procedure than the `glm()` function, which uses IWLS. But with
64 bits used to store very precise numbers, it's rare to encounter an noticeable
difference.

===

### Logistic Regression

Calling `glm` with `family = binomial` using the default "logit" link performs
logistic regression.

```{r glm_logit, title = '{{ site.handouts[0] }}'}
animals$sex <- factor(animals$sex)
fit <- glm(sex ~ log(hindfoot_length),
           family = binomial,
           data = animals)
```

===

```{r glm_logit_summary}
summary(fit)
```

===

### Observation Weights

Both the `lm()` and `glm()` function allow a vector of weights the same length
as the response. Weights can be necessary for logistic regression, depending on
the format of the data. The `binomial` family `glm()` works with three different
response variable formats.

1. `factor` with only or coerced to two levels (binary)
1. `matrix` with two columns for the count of "successes" and "failures"
1. `numeric` proprtion of "successes" out of `weights` trials

Depending on your model, these three formats are not necesarilly
interchangeable.
{:.notes}